## Non-Functional Requirements

---

### NFR-01 Performance

**Requirement**  
Для операции `GET /api/v1/feedback` при нагрузке 200 RPS время ответа сервиса  
(server-side latency) должно быть ≤ 300 мс на 95-м перцентиле.

**Verification**  
Нагрузочное тестирование в staging-окружении с профилем запроса,  
соответствующим production-трафику.  
Измерение p95 по server response time.

---

### NFR-02 Availability

**Requirement**  
Сервис должен обеспечивать доступность не ниже 99.9% в календарный месяц,  
за исключением согласованных окон планового обслуживания.

**Verification**  
Мониторинг SLA через систему мониторинга (uptime monitoring).  
Расчёт доступности на основании успешных health-check  
и HTTP-ответов со статусами 2xx и 3xx.

---

### NFR-03 Security (Authentication)

**Requirement**  
Все API-операции сервиса должны требовать аутентификацию по JWT  
(Bearer token), за исключением технических health-check эндпоинтов.

**Verification**  
Проверка через integration tests и security review:

- неавторизованный запрос к защищённому эндпоинту возвращает `401`;
- запрос с некорректным JWT возвращает `401`.

---

### NFR-04 Security (Vulnerability)

**Requirement**  
В продакшн-сборке не должно быть известных уязвимостей уровня _Critical_  
по шкале CVSS v3.x.

**Verification**  
Автоматизированный security scan перед релизом.  
Проверка отсутствия уязвимостей уровня _Critical_ в отчёте.

---

### NFR-05 Observability

**Requirement**  
Система должна присваивать каждому входящему HTTP-запросу уникальный `traceId`  
и включать его в структурированные логи для 100% запросов,  
включая ответы со статусами 4xx и 5xx.

**Verification**  
Проверка логов в тестовом окружении:

- каждый HTTP-запрос содержит `traceId`;
- `traceId` присутствует в соответствующей записи лога.

---

### NFR-06 Data Freshness

**Requirement**  
Агрегированные показатели, возвращаемые  
`GET /api/v1/feedback/analytics`,  
должны обновляться с задержкой не более 15 минут  
относительно времени поступления отзывов.

**Verification**  
Функциональный тест:

1. создать отзыв;
2. проверить появление его влияния на агрегаты  
   не позднее чем через 15 минут.

---

### NFR-07 External Interface (Date/Time Format)

**Requirement**  
Все значения даты и времени в API должны передаваться  
в формате RFC3339 в часовом поясе UTC.

**Verification**  
Проверка API-контрактов и ответов сервиса:

- формат соответствует RFC3339;
- используется временная зона UTC;
- отсутствуют локальные форматы времени.
